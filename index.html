<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign Up | Odin Project Practice</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="page">
      <aside class="brand-panel">
        <div class="branding">
          <img src="assets/images/odin-logo.svg" alt="Stylized Odin logo" />
          <span class="brand-text">ODIN</span>
        </div>
        <p class="asset-credit">
          Background illustration created by ChatGPT. Logo inspired by Norse motifs.
        </p>
      </aside>
      <main class="content">
        <section class="intro">
          <p>
            This is not a real online service! You know you need something like
            this in your life to help you realize your deepest dreams. Sign up
            now to get started.
          </p>
          <p>You know you want to.</p>
        </section>
        <section class="form-section">
          <h2>Let's do this!</h2>
          <form action="#" method="post" novalidate>
            <div class="field-grid">
              <label class="input-group" for="first-name">
                <span>First name</span>
                <input
                  type="text"
                  id="first-name"
                  name="first-name"
                  autocomplete="given-name"
                  placeholder="Jane"
                  required
                />
                <span class="error-message" aria-live="polite"></span>
              </label>
              <label class="input-group" for="last-name">
                <span>Last name</span>
                <input
                  type="text"
                  id="last-name"
                  name="last-name"
                  autocomplete="family-name"
                  placeholder="Doe"
                  required
                />
                <span class="error-message" aria-live="polite"></span>
              </label>
              <label class="input-group" for="email">
                <span>Email</span>
                <input
                  type="email"
                  id="email"
                  name="email"
                  autocomplete="email"
                  placeholder="jane.doe@example.com"
                  required
                />
                <span class="error-message" aria-live="polite"></span>
              </label>
              <label class="input-group" for="phone">
                <span>Phone number</span>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  autocomplete="tel"
                  placeholder="(555) 123-4567"
                  pattern="[0-9\-\s\(\)]+"
                  required
                />
                <span class="error-message" aria-live="polite"></span>
              </label>
              <label class="input-group" for="password">
                <span>Password</span>
                <input
                  type="password"
                  id="password"
                  name="password"
                  placeholder="Enter a strong password"
                  required
                  minlength="8"
                />
                <span class="error-message" aria-live="polite"></span>
              </label>
              <label class="input-group" for="confirm-password">
                <span>Confirm password</span>
                <input
                  type="password"
                  id="confirm-password"
                  name="confirm-password"
                  placeholder="Repeat your password"
                  required
                  minlength="8"
                />
                <span class="error-message" aria-live="polite"></span>
              </label>
            </div>
            <button type="submit" class="cta">Create Account</button>
            <p class="form-feedback" role="status" aria-live="polite"></p>
          </form>
        </section>
        <p class="login-callout">
          Already have an account? <a href="#">Log in</a>
        </p>
      </main>
    </div>
    <script>
      (function () {
        'use strict';
        const form = document.querySelector('.form-section form');
        if (!form) return;

        const inputs = Array.from(form.querySelectorAll('input'));
        const submitBtn = form.querySelector('button[type="submit"]');
        const feedbackEl = form.querySelector('.form-feedback');
        const passwordInput = form.querySelector('#password');
        const confirmPasswordInput = form.querySelector('#confirm-password');
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        const phonePattern = /^[0-9()\-\s]+$/;

        function getValidationMessage(input) {
          const value = input.value.trim();
          switch (input.id) {
            case 'first-name':
              return value ? '' : 'First name is required.';
            case 'last-name':
              return value ? '' : 'Last name is required.';
            case 'email':
              if (!value) return 'Email is required.';
              return emailPattern.test(value)
                ? ''
                : 'Enter a valid email address.';
            case 'phone':
              if (!value) return 'Phone number is required.';
              return phonePattern.test(value)
                ? ''
                : 'Use numbers, spaces, parentheses or dashes only.';
            case 'password':
              if (!value) return 'Password is required.';
              return value.length >= 8
                ? ''
                : 'Password must be at least 8 characters long.';
            case 'confirm-password':
              if (!value) return 'Please confirm your password.';
              return value === (passwordInput ? passwordInput.value : '')
                ? ''
                : 'Passwords do not match.';
            default:
              return '';
          }
        }

        function setGroupState(group, state, message) {
          if (!group) return;
          const errorEl = group.querySelector('.error-message');
          if (state === 'error') {
            group.dataset.state = 'error';
            if (errorEl) errorEl.textContent = message;
          } else if (state === 'success') {
            group.dataset.state = 'success';
            if (errorEl) errorEl.textContent = '';
          } else {
            group.removeAttribute('data-state');
            if (errorEl) errorEl.textContent = '';
          }
        }

        function updateFieldState(input, { displayMessage = false } = {}) {
          const message = getValidationMessage(input);
          const group = input.closest('.input-group');
          const shouldDisplay =
            displayMessage ||
            input.dataset.touched === 'true' ||
            form.dataset.submitted === 'true';

          if (message) {
            if (shouldDisplay) {
              setGroupState(group, 'error', message);
              input.setAttribute('aria-invalid', 'true');
            } else {
              setGroupState(group, null);
              input.removeAttribute('aria-invalid');
            }
            return false;
          }

          input.removeAttribute('aria-invalid');
          if (input.value.trim()) {
            setGroupState(group, 'success');
          } else {
            setGroupState(group, null);
          }
          return true;
        }

        function isFormValid() {
          return inputs.every((input) => getValidationMessage(input) === '');
        }

        function updateSubmitState() {
          const valid = isFormValid();
          submitBtn.disabled = !valid;
          if (valid) {
            submitBtn.removeAttribute('aria-disabled');
          } else {
            submitBtn.setAttribute('aria-disabled', 'true');
          }
        }

        inputs.forEach((input) => {
          input.addEventListener('input', () => {
            input.dataset.touched = 'true';
            updateFieldState(input);
            if (
              input.dataset.touched === 'true' ||
              form.dataset.submitted === 'true'
            ) {
              updateFieldState(input, { displayMessage: true });
            }
            if (input === passwordInput && confirmPasswordInput) {
              updateFieldState(confirmPasswordInput);
              if (
                confirmPasswordInput.dataset.touched === 'true' ||
                form.dataset.submitted === 'true'
              ) {
                updateFieldState(confirmPasswordInput, { displayMessage: true });
              }
            }
            if (feedbackEl) {
              feedbackEl.textContent = '';
              feedbackEl.removeAttribute('data-state');
            }
            updateSubmitState();
          });

          input.addEventListener('blur', () => {
            input.dataset.touched = 'true';
            updateFieldState(input, { displayMessage: true });
            updateSubmitState();
          });
        });

        form.addEventListener('submit', (event) => {
          form.dataset.submitted = 'true';
          const validity = inputs.map((input) => {
            input.dataset.touched = 'true';
            return updateFieldState(input, { displayMessage: true });
          });
          const allValid = validity.every(Boolean);

          if (!allValid) {
            event.preventDefault();
            if (feedbackEl) {
              feedbackEl.textContent = 'Please fix the highlighted fields.';
              feedbackEl.dataset.state = 'error';
            }
            const firstInvalid = inputs.find(
              (input) => getValidationMessage(input) !== ''
            );
            if (firstInvalid) {
              firstInvalid.focus();
            }
            updateSubmitState();
            return;
          }

          event.preventDefault();
          if (feedbackEl) {
            feedbackEl.textContent = 'Success! Your account is ready to go.';
            feedbackEl.dataset.state = 'success';
          }
          form.reset();
          delete form.dataset.submitted;
          inputs.forEach((input) => {
            delete input.dataset.touched;
            const group = input.closest('.input-group');
            setGroupState(group, null);
            input.removeAttribute('aria-invalid');
          });
          updateSubmitState();
        });

        updateSubmitState();
      })();
    </script>
  </body>
</html>

